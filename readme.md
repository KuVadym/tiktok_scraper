Тестове завдання ТікТок парсер

1. Виконує авторизацію в TikTok через браузер. (можна спростити і використовувати сессію, на яку зайшли раніше)
2. Проглядає відео у стрічці за результатами пошуку.
3. Із заданою ймовірністю або повністю переглядає відео, або одразу переходить до наступного.
(змінна skip_percent = 12, вона показує, що з 12% відео треба пролистати на наступне)
4. з відео витягуємо посилання, кількість переглядів, кількість лайків, кількість коментів
і записуємо в csv файл
5. Із заданою ймовірністю ставиться лайк на відео
(змінна like_percent = 12, вона показує, що з 12% відео треба поставити лайк)
6. Із заданою ймовірністю залишається комент для відео
(змінна comment_percent = 12, вона показує, що з 12% треба залишити коммент для відео)
комент будь який (Наприклад. "Круте відео")

Висновки по виконанню завдання
Було виконано: 
- спрощену версію пункту 1 — авторизація через раніше збережену сесію
- пошук відео за ключовими словами.
- із заданою ймовірністю відео переглядаються повністю або пропускаються (параметр skip_percent).
- витягається  інформація із сторінки: посилання на відео, кількість переглядів, , кількість лайків, кількість коментів.
- дані зберігаються у .csv файлі.
із заданою ймовірністю реалізовано:
- встановлення лайку (like_percent)
- залишення коментаря (comment_percent)

Проблема яка лишилася у мене не вирішеною - розпізнаванням бота
Це проявляється у тому, що:
Лайк начебто ставиться, але через кілька секунд TikTok скидає стан лайку.
Це відбувається навіть при імітації "людської" взаємодії (реалістична затримка, переміщення мишки тощо).
Та навіть я кщо самому поставити лайк. з відкритого власноруч браузера (не скриптом)
Цей момент був врахований у логіці обробки: додано перевірку атрибута aria-pressed до і після кліку, щоб відслідковувати успішність взаємодії.
Схожа ситуація з коментрями. Залишити їх не є можливим

Коротко
Парсер працює згідно з ТЗ, з урахуванням обмежень платформи TikTok щодо автоматичних дій. Проблему зі скиданням лайків було зафіксовано та описано. 


Запуск додатку

1. python -m venv venv
2. .\venv\Scripts\activate.ps1
3. pip install -r requirements.txt
4. playwright install
5. Збереження даних сесії в json документі tiktok_session.json
6. python -m run




Опис проекту:

Структтура:
<pre><code>```text 
project/
│
├── run.py                 # Точка входу, запуск всіх корутин
├── browser.py              # Створення браузера та контексту Playwright
├── scraper_utils.py        # Робота зі сторінкою: капча, лайки, коментарі, інше
├── scraping.py             # Основна логіка скрейпінгу
├── config.py               # Конфігураційні параметри
├── data_processing.py      # Збір та збереження даних у CSV
``` </code></pre>


| Файл                    | Функція                                           | Опис                                                           |
| ----------------------- | ------------------------------------------------- | -------------------------------------------------------------- |
| **run .py**             | `main()`                                          | Основна точка входу. Створює браузер, запускає `scrape_search` |
| **browser.py**          | `create_browser_with_session()`                   | Створює браузер і контекст на основі сесії                     |
|                         | `create_browser_with_new_context()`               | Альтернатива для нового контексту                              |
| **utils.py**            | `check_captcha(page)`                             | Очікує зникнення капчі                                         |
|                         | `get_video_duration(page)`                        | Витягує тривалість відео                                       |
|                         | `like_video(page)`                                | Натискає лайк (з імітацією людини)                             |
|                         | `leave_comment(page, comment_text)`               | Залишає коментар                                               |
|                         | `get_video_links(page)`                           | Збирає посилання на відео зі сторінки                          |
|                         | `should_execute_event(probability)`               | Повертає True/False на основі ймовірності                      |
|                         | `save_posts_to_csv(path)`                         | Зберігає дані                                                  |
|                         | `retry_async`                                     | повторює функцію у разі помилки                                |
| **scraping.py**         | `scrap_necessary_data(data, href)`                | Збирає дані зі сторінки                                        |
| **data\_processing.py** | `watch_videos(page)`                              | Парсить дані про відео (перегляди, коментарі тощо)             |
|                         |                                                   | Зберігає список відео в CSV-файл                               |
|                         |`search_links(data)`                               | Пошук посилань на відео на сторінці пошуку                     |
| **config.py**           | `like_percent`, `comment_percent`, `skip_percent` | Ймовірності взаємодій                                          |
|                         | Інші константи                                    |                                                                |


Подальша робота над завданням:
1. Реалізувати процес входу, у разі відсутності сесії

2. Реалізувати класову архітектуру
 Створити TikTokBot клас, з методами login(), search_videos(), like_video(), comment_video() тощо.

 Це дозволяє:

Зберігати спільний стан (наприклад, self.page, self.context).

Легше тестувати і підключати нові методи.


3. Розбити великий utils.py на менші модулі
<pre><code>```text 
utils/
├── selectors.py            # CSS/XPath селектори
├── logger.py               # логер
├── retry.py                # retry-декоратор
├── actions.py              # like, comment, scroll
├── extractors.py           # парсинг даних із сторінки
├── captcha.py              # обхід капчі
``` </code></pre>

4. Переписати під мікросервісну архітектуру
✅ Поділити логіку на окремі асинхронні сервіси або навіть процеси/контейнери:

- session_service: створює браузер, контекст, логін.

- scraper_service: збирає відео та метадані.

- interaction_service: лайки, коментарі, сабскрайб.

- controller_service: координує дії та потік між сервісами.

- captcha_service: реагує на появу капчі.

5. Логування в окремі файли:
* logs/error.log — помилки.

* logs/activity.log — дії бота.

* logs/stats.csv — кількість лайків/коментарів за сесію.